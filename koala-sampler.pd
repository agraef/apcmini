#N canvas 583 359 433 353 12;
#X declare -path lib;
#X obj 150 120 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000;
#X obj 217 120 hradio 15 0 0 3 empty empty empty 0 -8 0 10 #fcfcfc
#000000 #000000 0;
#N canvas 659 404 836 397 banks 0;
#X msg 20 100 64;
#X obj 20 130 until;
#X obj 20 161 f;
#X obj 50 161 + 1;
#X obj 20 74 t b b;
#X msg 70 100 0;
#X obj 20 219 div 8;
#X obj 80 219 mod 8;
#X obj 20 310 pack f f;
#X obj 20 190 t f f f;
#X msg 20 339 pad \$2 \$1 7;
#X obj 140 74 sel 0 1 2;
#X msg 140 103 33 41;
#X obj 140 161 t b a;
#X obj 360 50 loadbang;
#X obj 360 79 t b b;
#X msg 392 110 0;
#X obj 392 140 value bank;
#X obj 300 140 value bank;
#X obj 440 74 t b f;
#X obj 300 169 t f f;
#X obj 300 290 sel 0 1 2;
#X msg 300 319 0 1;
#X msg 340 319 1 1;
#X msg 380 319 1 0;
#X msg 300 348 banks 0 0 \$1 \$2;
#X obj 300 10 inlet;
#X obj 440 10 inlet;
#X obj 20 370 s apc-in;
#X obj 140 10 r init;
#X obj 510 50 closebang;
#X msg 510 146 64;
#X obj 510 176 until;
#X obj 510 207 f;
#X obj 540 207 + 1;
#X obj 510 120 t b b;
#X msg 560 146 0;
#X msg 510 236 pad \$1 0 0;
#X obj 510 265 s apc-in;
#X msg 600 236 key 0 \, assign 0 \, banks 0 0 0 0;
#X obj 510 79 t b b;
#X obj 600 50 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X obj 140 40 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X text 510 10 closebang takes down the entire display when exiting.
, f 38;
#X msg 240 103 4 12;
#X msg 190 103 41 4;
#X obj 172 200 unpack f f f f f f;
#N canvas 1920 385 542 300 colors 0;
#X obj 13 26 inlet;
#X obj 63 26 inlet;
#X obj 113 26 inlet;
#X obj 163 26 inlet;
#X obj 213 26 inlet;
#X obj 263 26 inlet;
#X obj 313 26 inlet;
#X obj 363 26 inlet;
#X obj 13 169 outlet;
#X obj 40 80 expr if($f1<4 \, if($f2<4 \, $f3 \, $f4) \, if($f1>=6
\, if($f2<4 \, $f5 \, $f6) \, if($f2<4 \, $f7 \, $f8))), f 65;
#X connect 0 0 9 0;
#X connect 1 0 9 1;
#X connect 2 0 9 2;
#X connect 3 0 9 3;
#X connect 4 0 9 4;
#X connect 5 0 9 5;
#X connect 6 0 9 6;
#X connect 7 0 9 7;
#X connect 9 0 8 0;
#X restore 140 260 pd colors;
#X msg 140 130 \$1 \$2 34 42 2 8;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 0 9 0;
#X connect 3 0 2 1;
#X connect 4 0 0 0;
#X connect 4 1 5 0;
#X connect 5 0 2 1;
#X connect 6 0 47 0;
#X connect 7 0 47 1;
#X connect 8 0 10 0;
#X connect 9 0 6 0;
#X connect 9 1 7 0;
#X connect 9 2 8 1;
#X connect 10 0 28 0;
#X connect 11 0 12 0;
#X connect 11 1 45 0;
#X connect 11 2 44 0;
#X connect 12 0 48 0;
#X connect 13 0 4 0;
#X connect 13 1 46 0;
#X connect 14 0 15 0;
#X connect 15 0 18 0;
#X connect 15 1 16 0;
#X connect 16 0 17 0;
#X connect 18 0 20 0;
#X connect 19 0 18 0;
#X connect 19 1 17 0;
#X connect 20 0 11 0;
#X connect 20 1 21 0;
#X connect 21 0 22 0;
#X connect 21 1 23 0;
#X connect 21 2 24 0;
#X connect 22 0 25 0;
#X connect 23 0 25 0;
#X connect 24 0 25 0;
#X connect 25 0 28 0;
#X connect 26 0 18 0;
#X connect 27 0 19 0;
#X connect 29 0 42 0;
#X connect 30 0 40 0;
#X connect 31 0 32 0;
#X connect 32 0 33 0;
#X connect 33 0 34 0;
#X connect 33 0 37 0;
#X connect 34 0 33 1;
#X connect 35 0 31 0;
#X connect 35 1 36 0;
#X connect 36 0 33 1;
#X connect 37 0 38 0;
#X connect 39 0 38 0;
#X connect 40 0 35 0;
#X connect 40 1 39 0;
#X connect 41 0 40 0;
#X connect 42 0 18 0;
#X connect 44 0 48 0;
#X connect 45 0 48 0;
#X connect 46 0 47 2;
#X connect 46 1 47 3;
#X connect 46 2 47 4;
#X connect 46 3 47 5;
#X connect 46 4 47 6;
#X connect 46 5 47 7;
#X connect 47 0 8 0;
#X connect 48 0 13 0;
#X restore 150 150 pd banks;
#X obj 40 21 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000;
#X obj 310 310 pd-remote;
#X msg 310 280 pdluax reload;
#X obj 40 50 midi-input;
#X obj 40 311 midi-output;
#X obj 40 150 apcmini;
#X obj 150 310 declare -path lib;
#N canvas 671 422 582 287 control 0;
#X obj 20 109 sel 0;
#X msg 73 110 1;
#X msg 110 110 -1;
#N canvas 842 518 237 259 change-bank 0;
#X obj 20 73 t b f;
#X obj 20 102 value bank;
#X obj 20 131 +;
#X obj 20 30 inlet;
#X obj 20 210 outlet;
#X obj 20 160 mod 3;
#X connect 0 0 1 0;
#X connect 0 1 2 1;
#X connect 1 0 2 0;
#X connect 2 0 5 0;
#X connect 3 0 0 0;
#X connect 5 0 4 0;
#X restore 73 140 pd change-bank;
#N canvas 786 470 928 389 pad 0;
#X floatatom 10 209 5 0 0 0 - - -, f 5;
#X obj 10 40 unpack f f;
#X floatatom 77 209 5 0 0 0 - - -, f 5;
#X obj 10 237 pack f f;
#X msg 10 266 note \$1 \$2 26;
#X obj 10 10 inlet;
#X obj 10 340 outlet;
#X obj 10 109 moses 32;
#X floatatom 170 209 5 0 0 0 - - -, f 5;
#X floatatom 237 209 5 0 0 0 - - -, f 5;
#X obj 170 237 pack f f;
#X obj 170 110 - 32;
#X obj 10 150 expr ($f1%8>=4)*12+int($f1/8)*4+($f1%8)+bank*16;
#X obj 170 180 expr ($f1%8>=4)*12+int($f1/8)*4+($f1%8);
#X msg 170 266 note \$1 \$2 26;
#X obj 10 70 moses 64;
#X floatatom 240 30 5 0 0 0 - - -, f 5;
#X obj 240 58 - 64;
#X obj 240 87 expr ($f1%8>=4)*12 + int($f1/8)*4 + ($f1%8) + ($f1>=32)*16
;
#X obj 10 180 + 36;
#X text 300 40 drum mode (mk2 only);
#X connect 0 0 3 0;
#X connect 1 0 15 0;
#X connect 1 1 2 0;
#X connect 1 1 9 0;
#X connect 2 0 3 1;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 5 0 1 0;
#X connect 7 0 12 0;
#X connect 7 1 11 0;
#X connect 8 0 10 0;
#X connect 9 0 10 1;
#X connect 10 0 14 0;
#X connect 11 0 13 0;
#X connect 12 0 19 0;
#X connect 13 0 8 0;
#X connect 14 0 6 0;
#X connect 15 0 7 0;
#X connect 15 1 16 0;
#X connect 16 0 17 0;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 19 0 0 0;
#X restore 190 140 pd pad;
#N canvas 846 359 450 415 fader 0;
#X msg 40 111 0;
#X msg 80 111 1;
#X msg 120 111 2;
#X msg 160 111 3;
#X obj 156 191 unpack f f;
#X obj 40 220 expr $f1*9+21+$f2;
#X floatatom 40 249 5 0 0 0 - - -, f 5;
#X obj 40 277 pack f f;
#X msg 40 306 ctl \$2 \$1 17;
#X obj 40 80 t b a;
#X obj 90 80 t b a;
#X obj 140 80 t b a;
#X obj 190 80 t b a;
#X obj 13 26 inlet;
#X obj 63 26 inlet;
#X obj 113 26 inlet;
#X obj 163 26 inlet;
#X obj 13 379 outlet;
#X connect 0 0 5 0;
#X connect 1 0 5 0;
#X connect 2 0 5 0;
#X connect 3 0 5 0;
#X connect 4 0 5 1;
#X connect 4 1 7 1;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 17 0;
#X connect 9 0 0 0;
#X connect 9 1 4 0;
#X connect 10 0 1 0;
#X connect 10 1 4 0;
#X connect 11 0 2 0;
#X connect 11 1 4 0;
#X connect 12 0 3 0;
#X connect 12 1 4 0;
#X connect 13 0 9 0;
#X connect 14 0 10 0;
#X connect 15 0 11 0;
#X connect 16 0 12 0;
#X restore 250 140 pd fader;
#X obj 20 23 inlet;
#X obj 20 210 outlet;
#X obj 73 210 outlet;
#N canvas 366 221 450 300 solo 0;
#X obj 20 70 sel 0 1 2 3 4 5 6 7;
#X obj 20 100 solo 0;
#X obj 20 30 inlet;
#X obj 20 180 outlet;
#X obj 76 180 outlet;
#X obj 69 100 solo 1;
#X obj 118 100 solo 2;
#X obj 167 100 solo 3;
#X obj 216 100 solo 4;
#X obj 265 100 solo 5;
#X obj 314 100 solo 6;
#X obj 363 100 solo 7;
#X connect 0 0 1 0;
#X connect 0 1 5 0;
#X connect 0 2 6 0;
#X connect 0 3 7 0;
#X connect 0 4 8 0;
#X connect 0 5 9 0;
#X connect 0 6 10 0;
#X connect 0 7 11 0;
#X connect 1 0 3 0;
#X connect 1 1 4 0;
#X connect 2 0 0 0;
#X connect 5 0 3 0;
#X connect 5 1 4 0;
#X connect 6 0 3 0;
#X connect 6 1 4 0;
#X connect 7 0 3 0;
#X connect 7 1 4 0;
#X connect 8 0 3 0;
#X connect 8 1 4 0;
#X connect 9 0 3 0;
#X connect 9 1 4 0;
#X connect 10 0 3 0;
#X connect 10 1 4 0;
#X connect 11 0 3 0;
#X connect 11 1 4 0;
#X restore 324 140 pd solo;
#N canvas 366 221 450 300 mute 0;
#X obj 20 70 sel 0 1 2 3 4 5 6 7;
#X obj 20 30 inlet;
#X obj 20 180 outlet;
#X obj 76 180 outlet;
#X obj 20 100 mute 0;
#X obj 69 100 mute 1;
#X obj 118 100 mute 2;
#X obj 167 100 mute 3;
#X obj 216 100 mute 4;
#X obj 265 100 mute 5;
#X obj 314 100 mute 6;
#X obj 363 100 mute 7;
#X connect 0 0 4 0;
#X connect 0 1 5 0;
#X connect 0 2 6 0;
#X connect 0 3 7 0;
#X connect 0 4 8 0;
#X connect 0 5 9 0;
#X connect 0 6 10 0;
#X connect 0 7 11 0;
#X connect 1 0 0 0;
#X connect 4 0 2 0;
#X connect 4 1 3 0;
#X connect 5 0 2 0;
#X connect 5 1 3 0;
#X connect 6 0 2 0;
#X connect 6 1 3 0;
#X connect 7 0 2 0;
#X connect 7 1 3 0;
#X connect 8 0 2 0;
#X connect 8 1 3 0;
#X connect 9 0 2 0;
#X connect 9 1 3 0;
#X connect 10 0 2 0;
#X connect 10 1 3 0;
#X connect 11 0 2 0;
#X connect 11 1 3 0;
#X restore 397 140 pd mute;
#X obj 20 80 route mode bank-right bank-left pad vol pan send dev solo
mute scene, f 68;
#N canvas 0 0 450 300 scene 0;
#X obj 40 80 unpack f f;
#X obj 40 110 + 72;
#X obj 40 145 pack f f;
#X msg 40 174 note \$1 \$2 32;
#X obj 13 26 inlet;
#X obj 13 247 outlet;
#X connect 0 0 1 0;
#X connect 0 1 2 1;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 0 0;
#X restore 470 140 pd scene;
#X obj 209 210 s apc-in;
#X obj 129 210 s midi-out;
#X connect 0 0 7 0;
#X connect 1 0 3 0;
#X connect 2 0 3 0;
#X connect 3 0 8 0;
#X connect 4 0 14 0;
#X connect 5 0 14 0;
#X connect 6 0 11 0;
#X connect 9 0 13 0;
#X connect 9 1 14 0;
#X connect 10 0 13 0;
#X connect 10 1 14 0;
#X connect 11 0 0 0;
#X connect 11 1 1 0;
#X connect 11 2 2 0;
#X connect 11 3 4 0;
#X connect 11 4 5 0;
#X connect 11 5 5 1;
#X connect 11 6 5 2;
#X connect 11 7 5 3;
#X connect 11 8 9 0;
#X connect 11 9 10 0;
#X connect 11 10 12 0;
#X connect 12 0 14 0;
#X restore 150 80 pd control;
#X obj 310 220 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000;
#N canvas 1060 484 425 379 init 0;
#X msg 52 130 model;
#X obj 100 30 loadbang;
#X obj 100 59 del 500;
#X obj 20 30 inlet;
#X obj 52 157 s apc-in;
#X obj 20 100 t b b;
#X obj 20 219 t b b;
#X obj 52 278 s apc-in;
#X msg 52 250 mode 0;
#X obj 20 320 del 100;
#X obj 20 349 s init;
#X obj 20 190 del 500;
#X text 180 30 Wait until MIDI connections are established \, try to
figure out the model (mk1 or mk2) \, wait some more for the reply \,
then force the device to standard cliplaunch mode (mk2 only) \, wait
some more \, then initialize the pad display (this is done in the banks
subpatch). This whole rigmarole is needed to have the mk2 properly
initialized in case it's in drum or note mode at startup., f 31;
#X connect 0 0 4 0;
#X connect 1 0 2 0;
#X connect 2 0 5 0;
#X connect 3 0 5 0;
#X connect 5 0 11 0;
#X connect 5 1 0 0;
#X connect 6 0 9 0;
#X connect 6 1 8 0;
#X connect 8 0 7 0;
#X connect 9 0 10 0;
#X connect 11 0 6 0;
#X restore 310 240 pd init;
#X obj 310 110 spigot;
#X obj 349 80 tgl 15 1 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 1 1;
#X obj 40 110 r apc-in;
#X obj 40 280 r midi-out;
#X obj 72 250 s apc-out;
#X obj 150 50 r apc-out;
#X obj 40 224 t a a;
#N canvas 997 540 450 300 log 0;
#X obj 119 110 print;
#X obj 10 30 inlet;
#X obj 40 240 route stop solo mute rec sel note sysex;
#X obj 10 80 route note sysex;
#X text 10 160 the messages that may be output by the external: stop
to stop clips in a track \, track controls (solo \, mute \, rec arm
\, and select) \, and note and sysex which should be passed on to midi-output
;
#X text 140 80 print everything but note and sysex;
#X connect 1 0 3 0;
#X connect 3 2 0 0;
#X restore 310 141 pd log;
#X obj 310 50 r apc-out;
#X connect 0 0 2 0;
#X connect 1 0 2 1;
#X connect 3 0 8 0;
#X connect 5 0 4 0;
#X connect 6 0 8 0;
#X connect 8 0 19 0;
#X connect 10 0 0 0;
#X connect 10 1 1 0;
#X connect 11 0 12 0;
#X connect 13 0 20 0;
#X connect 14 0 13 1;
#X connect 15 0 8 0;
#X connect 16 0 7 0;
#X connect 18 0 10 0;
#X connect 19 0 7 0;
#X connect 19 1 17 0;
#X connect 21 0 13 0;
